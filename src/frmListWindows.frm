rsion =20
VersionRequired =20
Checksum =1480054492
Begin Form
    AllowDesignChanges = NotDefault
    DefaultView =0
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =8520
    DatasheetFontHeight =10
    ItemSuffix =3
    Right =17580
    Bottom =9705
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x18d05a3b8cc3e240
    End
    GUID = Begin
        0x5301b322aa3f3b4e81a85bfa5be9a854
    End
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x000030002e00630068006d0000002500000000000c4c1700d1dd2500d6dd2500 ,
        0x010403069c0040030fff800301000100ea0a6f08640001000700580202000100 ,
        0x5802020000004c6574746572000072679c4e17009067d50f180000000c000000 ,
        0x884e1700584c0000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff4749533400000000000000000000000044494e55 ,
        0x2200c80024031c003f5d7b7e0000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000090001000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000c8000000534d544a ,
        0x000000001000b8007b00300038003400460030003100460041002d0045003600 ,
        0x330034002d0034004400370037002d0038003300450045002d00300037003400 ,
        0x3800310037004300300033003500380031007d000000524553444c4c00556e69 ,
        0x726573444c4c00506170657253697a65004c4554544552004f7269656e746174 ,
        0x696f6e00504f525452414954005265736f6c7574696f6e005265734f7074696f ,
        0x6e3100436f6c6f724d6f646500436f6c6f720000000000000000000000000000 ,
        0x1c0000005634444d0100000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000504f525450524f4d5054 ,
        0x3a00
    End
    FilterOnLoad =0
    DatasheetGridlinesColor12 =12632256
    PrtDevModeW = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x74006f0020005000440046000000000000000000000000000000000000000000 ,
        0x01040306dc0040030fff800301000100ea0a6f08640001000700580202000100 ,
        0x5802020000004c00650074007400650072000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000ffffffff4749533400000000000000000000000044494e55 ,
        0x2200c80024031c003f5d7b7e0000000000000000000000000000000000000000 ,
        0x0000000000000000050000000000090001000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000c8000000534d544a ,
        0x000000001000b8007b00300038003400460030003100460041002d0045003600 ,
        0x330034002d0034004400370037002d0038003300450045002d00300037003400 ,
        0x3800310037004300300033003500380031007d000000524553444c4c00556e69 ,
        0x726573444c4c00506170657253697a65004c4554544552004f7269656e746174 ,
        0x696f6e00504f525452414954005265736f6c7574696f6e005265734f7074696f ,
        0x6e3100436f6c6f724d6f646500436f6c6f720000000000000000000000000000 ,
        0x1c0000005634444d0100000000000000000000000000000000000000
    End
    PrtDevNamesW = Begin
        0x04001b0032000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000050004f0052005400500052004f004d00500054003a000000
    End
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
            BorderLineStyle =0
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            BorderLineStyle =0
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin Section
            Height =5940
            BackColor =-2147483633
            Name ="Detail"
            GUID = Begin
                0x1a5e34a07c44ac4d88686db855c464ab
            End
            Begin
                Begin TextBox
                    ScrollBars =2
                    OverlapFlags =85
                    Left =1560
                    Top =300
                    Width =6720
                    Height =5460
                    Name ="Text1"
                    GUID = Begin
                        0xe5f7334b7fbb0348a304c57120fe1b0e
                    End

                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =660
                            Top =300
                            Width =780
                            Height =600
                            Name ="Label1"
                            Caption ="Text1:"
                            GUID = Begin
                                0xef04f825ab1c7e4e923b6afb87d72c98
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    Left =120
                    Top =660
                    Width =1320
                    Height =660
                    TabIndex =1
                    Name ="Command1"
                    Caption ="Command1"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xed609f8cf78c374fa629cf0e7a9baf86
                    End

                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Sub AddChildWindows(ByVal hWndParent As Long, ByVal Level As Long)

    On Error GoTo PROC_ERR

    Dim WT As String
    Dim CN As String
    Dim Length As Long
    Dim hWnd As Long
      
    If Level = 0 Then
        hWnd = hWndParent
    Else
        hWnd = GetWindow(hWndParent, GW_CHILD)
    End If

    Do While hWnd <> 0
        WT = Space(256)
        Length = GetWindowText(hWnd, WT, 255)
        WT = Left$(WT, Length)
        CN = Space(256)
        Length = GetClassName(hWnd, CN, 255)
        CN = Left$(CN, Length)
        Me!Text1 = Me!Text1 & vbCrLf & String(2 * Level, ".") _
                        & WT & " (" & CN & ")"
        AddChildWindows hWnd, Level + 1
        hWnd = GetWindow(hWnd, GW_HWNDNEXT)
    Loop

PROC_EXIT:
    Exit Sub

PROC_ERR:
    MsgBox "Erl=" & Erl & " Error " & Err.Number & " (" & Err.Description & ") in procedure AddChildWindows of frmListWindows"
    Resume PROC_EXIT

End Sub

Private Sub Command1_Click()
     
    Dim hWnd As Long
    hWnd = GetTopWindow(0)
    If hWnd <> 0 Then
        AddChildWindows hWnd, 0
    End If

End Sub